package models

// VulnerabilityCard 漏洞卡片结构
type VulnerabilityCard struct {
	Name           string          `yaml:"name" json:"name"`
	Title          string          `yaml:"title" json:"title"`
	Severity       string          `yaml:"severity" json:"severity"`
	SeverityLevel  string          `yaml:"severity_level" json:"severity_level"`
	Icon           string          `yaml:"icon" json:"icon"`
	Description    string          `yaml:"description" json:"description"`
	CVSSScore      float64         `yaml:"cvss_score,omitempty" json:"cvss_score,omitempty"`
	CVSSVector     string          `yaml:"cvss_vector,omitempty" json:"cvss_vector,omitempty"`
	ThreatLevel    string          `yaml:"threat_level,omitempty" json:"threat_level,omitempty"`
	CVE            string          `yaml:"cve,omitempty" json:"cve,omitempty"`
	AdditionalInfo *AdditionalInfo `yaml:"additional_info,omitempty" json:"additional_info,omitempty"`
	Perspectives   []Perspective   `yaml:"perspectives" json:"perspectives"`
	FooterNote     string          `yaml:"footer_note" json:"footer_note"`
}

// AdditionalInfo 补充信息
type AdditionalInfo struct {
	CVEURL    string `yaml:"cve_url,omitempty" json:"cve_url,omitempty"`
	FOFAQuery string `yaml:"fofa_query,omitempty" json:"fofa_query,omitempty"`
	POCs      []POC  `yaml:"pocs,omitempty" json:"pocs,omitempty"`
	Tools     []Tool `yaml:"tools,omitempty" json:"tools,omitempty"`
}

// POC 概念验证代码或利用脚本
type POC struct {
	Name        string `yaml:"name" json:"name"`
	URL         string `yaml:"url" json:"url"`
	Description string `yaml:"description,omitempty" json:"description,omitempty"`
}

// Tool 相关工具
type Tool struct {
	Name        string `yaml:"name" json:"name"`
	URL         string `yaml:"url" json:"url"`
	Description string `yaml:"description,omitempty" json:"description,omitempty"`
}

// Perspective 视角
type Perspective struct {
	ID          string  `yaml:"id" json:"id"`
	Name        string  `yaml:"name" json:"name"`
	Icon        string  `yaml:"icon" json:"icon"`
	Title       string  `yaml:"title" json:"title"`
	Description string  `yaml:"description" json:"description"`
	Content     Content `yaml:"content" json:"content"`
}

// Content 内容
type Content struct {
	Columns  []Column  `yaml:"columns" json:"columns"`
	Sections []Section `yaml:"sections" json:"sections"`
}

// Column 列（用于 Content）
type Column struct {
	Boxes []Box `yaml:"boxes" json:"boxes"`
}

// SectionColumn 区块中的列（用于 Section）
type SectionColumn struct {
	Title   string      `yaml:"title" json:"title"`
	Content interface{} `yaml:"content" json:"content"`
}

// Box 信息框
type Box struct {
	Type         string      `yaml:"type" json:"type"`
	BorderColor  string      `yaml:"border_color,omitempty" json:"border_color,omitempty"`
	Title        string      `yaml:"title" json:"title"`
	Icon         string      `yaml:"icon" json:"icon"`
	Content      interface{} `yaml:"content,omitempty" json:"content,omitempty"`
	CodeExample  string      `yaml:"code_example,omitempty" json:"code_example,omitempty"`
	CodeExample2 string      `yaml:"code_example_2,omitempty" json:"code_example_2,omitempty"`
	ContentAfter string      `yaml:"content_after,omitempty" json:"content_after,omitempty"`
	ContentList  interface{} `yaml:"content_list,omitempty" json:"content_list,omitempty"`
}

// Section 区块
type Section struct {
	Type     string          `yaml:"type" json:"type"`
	Title    string          `yaml:"title" json:"title"`
	Icon     string          `yaml:"icon" json:"icon"`
	Steps    []string        `yaml:"steps,omitempty" json:"steps,omitempty"`
	Items    []ImpactItem    `yaml:"items,omitempty" json:"items,omitempty"`
	Examples []CodeExample   `yaml:"examples,omitempty" json:"examples,omitempty"`
	Headers  []string        `yaml:"headers,omitempty" json:"headers,omitempty"`
	Rows     [][]string      `yaml:"rows,omitempty" json:"rows,omitempty"`
	Columns  []SectionColumn `yaml:"columns,omitempty" json:"columns,omitempty"`
}

// ImpactItem 影响项
type ImpactItem struct {
	Icon        string `yaml:"icon" json:"icon"`
	Title       string `yaml:"title" json:"title"`
	Description string `yaml:"description" json:"description"`
	Color       string `yaml:"color" json:"color"`
}

// CodeExample 代码示例
type CodeExample struct {
	Title string `yaml:"title" json:"title"`
	Code  string `yaml:"code" json:"code"`
}

// ListContent 列表内容
type ListContent struct {
	Type  string   `yaml:"type" json:"type"`
	Items []string `yaml:"items" json:"items"`
}
